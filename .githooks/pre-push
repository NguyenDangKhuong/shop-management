#!/bin/bash

# Add npm to PATH for Git GUI
export PATH="/usr/local/bin:/opt/homebrew/bin:$PATH"

# Add Node.js paths
if command -v node &> /dev/null; then
    export PATH="$(dirname $(which node)):$PATH"
fi

echo "ğŸ” Running pre-push checks..."

echo ""
echo "ğŸ“ Running linter..."
npm run lint || {
    echo "âŒ Linting failed. Please fix linting errors before pushing."
    echo "ğŸ’¡ To skip this check, use: git push --no-verify"
    exit 1
}

echo ""
echo "ğŸ§ª Running tests..."
npm test || {
    echo "âŒ Tests failed. Please fix failing tests before pushing."
    echo "ğŸ’¡ To skip this check, use: git push --no-verify"
    exit 1
}

echo ""
echo "ğŸ—ï¸  Checking build..."
npm run build || {
    echo "âŒ Build failed. Please fix build errors before pushing."
    echo "ğŸ’¡ To skip this check, use: git push --no-verify"
    exit 1
}

echo ""
echo "âœ… All checks passed! Pushing to remote..."
